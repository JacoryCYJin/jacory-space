"use client";

import React, { useRef } from "react";
import { motion } from "framer-motion";
import { OrbitingCircles } from "../magicui/orbiting-circles";

const FullStackCard = ({ skills, language, cardData }) => {
  const containerRef = useRef(null);

  // 技术图标映射 - 预留SVG位置，你可以自己添加对应的图标
  const techIcons = {
    React: (
      <svg
        t="1756705757144"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="8129"
        width="40"
        height="40"
      >
        <path
          d="M512 511.8m-80 0a80 80 0 1 0 160 0 80 80 0 1 0-160 0Z"
          fill="#61DAFB"
          p-id="8130"
        ></path>
        <path
          d="M960.5 511.8c0-62.8-73.8-117.2-188.5-150.1 28.9-115.8 18.7-206.9-35.7-238.3-54.5-31.4-138.5 5.3-224.3 88.2-85.8-82.9-169.8-119.6-224.3-88.2-54.4 31.4-64.6 122.6-35.7 238.3C137.3 394.6 63.5 449 63.5 511.8S137.3 629 252 661.9c-28.9 115.7-18.7 206.9 35.7 238.3 13.4 7.8 28.6 11.6 45.2 11.6 39.7 0 87.8-21.8 140-64.2 13-10.6 26.1-22.6 39.1-35.2 13 12.6 26.1 24.6 39.1 35.2 52.2 42.4 100.2 64.2 140 64.2 16.6 0 31.8-3.8 45.2-11.6 54.4-31.4 64.6-122.5 35.7-238.3 114.7-32.9 188.5-87.3 188.5-150.1zM716.8 157.2c35.3 20.4 42.7 94.3 17.6 194.8-36.7-8.4-76.7-14.7-119.3-18.6-24.7-34.9-50.2-66.4-75.8-94 59.2-57.3 114.2-88.4 152-88.4 9.6-0.1 18.2 2 25.5 6.2zM637 584c-13.8 24-28.4 47-43.3 69-26.1 2-53.3 3.1-81.7 3.1-28.3 0-55.5-1.1-81.6-3.1-15-22-29.5-45.1-43.3-69-14.1-24.5-26.7-48.6-38.1-72.2 11.4-23.6 24-47.7 38.1-72.2 14.1-24.5 28.7-47.4 43.4-69.1 26.1-2 53.3-3.1 81.6-3.1 28.3 0 55.5 1.1 81.6 3.1 14.7 21.6 29.3 44.6 43.4 69 14.1 24.5 26.7 48.6 38.1 72.2-11.5 23.7-24.1 47.8-38.2 72.3z m58.8-26.4c11.2 26.6 20.4 52.1 28 76.5-24.9 5.6-51.7 10.4-80.3 14 9.3-14.5 18.4-29.3 27.3-44.6 8.8-15.4 17.1-30.7 25-45.9zM512 756.5c-17.7-19.2-35.1-40.1-52.2-62.6 17.1 0.8 34.5 1.3 52.2 1.3 17.7 0 35.1-0.5 52.2-1.3-17.1 22.5-34.5 43.4-52.2 62.6zM380.5 648.1c-28.6-3.6-55.3-8.4-80.3-14 7.6-24.4 16.8-49.9 28-76.5 7.9 15.2 16.1 30.5 25 45.9 8.9 15.2 18 30 27.3 44.6zM328.2 466c-11.2-26.6-20.4-52.1-28-76.5 24.9-5.6 51.6-10.4 80.2-14-9.2 14.4-18.4 29.2-27.2 44.6-8.8 15.4-17.1 30.7-25 45.9zM512 267.1c17.3 18.7 34.8 39.8 52.1 62.7-17.1-0.8-34.4-1.3-52.1-1.3-17.7 0-35 0.5-52.1 1.3 17.3-22.9 34.8-44 52.1-62.7z m158.7 153c-8.9-15.3-18-30.1-27.2-44.6 28.6 3.6 55.3 8.4 80.2 14-7.6 24.4-16.8 49.9-28 76.5-7.8-15.2-16.1-30.5-25-45.9zM307.2 157.2c7.2-4.2 15.8-6.2 25.6-6.2 37.8 0 92.7 31.1 151.9 88.4-25.6 27.6-51.1 59.2-75.8 94-42.5 3.9-82.6 10.2-119.3 18.6-25.1-100.6-17.6-174.5 17.6-194.8zM102.5 511.8c0-40.8 60.3-84.2 160-112.6 11.1 36 25.6 73.8 43.5 112.6-17.8 38.8-32.4 76.6-43.5 112.6-99.7-28.4-160-71.9-160-112.6z m345.8 305.5c-59.7 48.5-111.1 66.4-141.1 49.2-35.3-20.4-42.7-94.3-17.6-194.8 36.7 8.4 76.7 14.7 119.3 18.6 24.4 34.5 49.9 66.1 75.8 94.2-12.1 11.7-24.2 22.9-36.4 32.8z m268.5 49.2c-29.9 17.3-81.4-0.6-141.1-49.2-12.1-9.9-24.3-21.1-36.5-32.8 26-28.1 51.4-59.7 75.8-94.2 42.5-3.9 82.6-10.2 119.3-18.7 25.2 100.6 17.7 174.5-17.5 194.9z m44.8-242.1c-11.1-36-25.6-73.8-43.5-112.6 17.8-38.8 32.4-76.6 43.5-112.6 99.7 28.5 160 71.9 160 112.6-0.1 40.7-60.4 84.2-160 112.6z"
          fill="#61DAFB"
          p-id="8131"
        ></path>
      </svg>
    ),
    "Vue.js": (
      <svg
        t="1756705026474"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="7009"
        width="40"
        height="40"
      >
        <path
          d="M615.6 123.6h165.5L512 589.7 242.9 123.6H63.5L512 900.4l448.5-776.9z"
          fill="#41B883"
          p-id="7010"
        ></path>
        <path
          d="M781.1 123.6H615.6L512 303 408.4 123.6H242.9L512 589.7z"
          fill="#34495E"
          p-id="7011"
        ></path>
      </svg>
    ),
    TypeScript: (
      <svg
        t="1756705822643"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="10877"
        width="40"
        height="40"
      >
        <path
          d="M94.208 94.208v835.584h835.584V94.208H94.208z m634.92096 405.85216v0.012288c8.011776 0.024576 17.119232 0.436224 23.967744 1.179648 27.891712 3.016704 49.6128 15.050752 68.091904 37.715968 9.201664 11.290624 12.34944 16.2304 11.679744 18.343936-0.432128 1.363968-6.746112 5.885952-26.820608 19.21024-19.720192 13.092864-26.07104 17.014784-27.5456 17.014784-1.497088 0-4.614144-3.207168-9.105408-9.365504-8.6528-11.855872-17.485824-17.266688-31.13984-19.070976-14.68416-1.9456-27.856896 2.68288-34.308096 12.058624-5.515264 8.011776-6.3488 20.901888-1.96608 30.26944 5.07904 10.848256 14.270464 16.846848 49.494016 32.290816 40.624128 17.813504 61.210624 30.005248 76.204032 45.13792 16.146432 16.293888 24.326144 35.106816 26.83904 61.718528 1.226752 12.972032-0.272384 28.34432-3.98336 40.843264-9.10336 30.640128-33.66912 53.075968-69.67296 63.635456-9.95328 2.9184-19.214336 4.661248-28.37504 5.332992-13.985792 1.030144-34.002944 0.462848-46.051328-1.29024-30.482432-4.442112-64.892928-22.17984-82.051072-42.2912-8.423424-9.873408-19.177472-26.12224-19.177472-28.9792 0-1.380352 0.684032-2.164736 3.391488-3.885056 8.032256-5.103616 54.054912-31.412224 54.94784-31.412224 0.540672 0 2.945024 2.832384 5.341184 6.295552 5.429248 7.839744 18.78016 21.313536 25.567232 25.808896 5.543936 3.672064 12.634112 6.619136 21.051392 8.747008 4.820992 1.202176 7.3728 1.417216 17.891328 1.417216 10.747904-0.004096 12.951552-0.18432 17.760256-1.476608 12.71808-3.422208 22.644736-10.50624 26.851328-19.156992 1.8432-3.7376 1.880064-4.204544 1.880064-13.27104v-9.40032l-2.260992-4.48512c-5.474304-10.866688-17.270784-18.323456-54.56896-34.47808-17.13152-7.421952-38.11328-17.885184-46.30528-23.0912-18.696192-11.880448-31.653888-25.462784-40.157184-42.088448-8.45824-16.533504-9.71776-22.687744-9.73824-47.548416-0.02048-19.462144-0.053248-19.222528 3.975168-31.643648 3.65568-11.272192 11.139072-23.863296 19.400704-32.64512 16.4864-17.524736 40.577024-28.788736 66.367488-31.029248 3.29728-0.313344 7.716864-0.434176 12.52352-0.41984z m-221.92128 3.844096h0.008192c49.670144 0.024576 78.143488 0.196608 78.600192 0.483328 0.86016 0.53248 0.968704 4.855808 0.968704 32.444416v31.827968l-49.563648 0.180224-49.563648 0.180224v140.724224c0 77.400064-0.157696 141.185024-0.372736 141.748224-0.350208 0.948224-4.163584 1.019904-36.41344 1.019904h-36.018176l-0.372736-1.45408c-0.239616-0.79872-0.415744-64.587776-0.41984-141.750272l-0.012288-140.296192-49.5616-0.176128-49.565696-0.180224v-31.451136c0-24.94464 0.172032-31.625216 0.837632-32.288768 0.681984-0.702464 25.976832-0.882688 134.967296-0.991232 21.01248-0.02048 39.92576-0.03072 56.48384-0.02048z"
          fill="#0288D1"
          p-id="10878"
        ></path>
      </svg>
    ),
    Springboot: (
      <svg
        t="1756705901465"
        class="icon"
        viewBox="0 0 1025 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="1593"
        width="40"
        height="40"
      >
        <path
          d="M155.731808 143.581954a509.861674 509.861674 0 0 1 721.912932 12.586544 445.222307 445.222307 0 0 0 54.82613-95.785729c63.999373 195.838082 103.252322 360.316472 88.319135 487.675225a510.075006 510.075006 0 0 1-837.538466 354.129865l-4.266625-3.626631-2.133312-2.559975a39.252949 39.252949 0 0 1-6.186606-4.053293l-6.399938-6.613269a212.051257 212.051257 0 0 1-18.986481-17.493162l-2.133312-2.559975A510.714999 510.714999 0 0 1 155.731808 143.581954z m75.945923 685.859951A43.370242 43.370242 0 0 0 170.664996 891.094635l8.106587 7.253262a42.666249 42.666249 0 0 0 57.386105-7.679925 44.372899 44.372899 0 0 0-6.186606-61.226067z m695.459857-716.57965c-52.692817 110.718916-183.46487 194.984757-296.103767 221.437832-106.665622 25.173087-199.251382 4.266625-297.170423 42.666249-223.357813 85.332498-219.091188 350.929897-97.065717 411.089308l7.466594 4.053293s88.319135-17.493162 175.571614-40.532936l7.466594-2.133313c34.986324-9.386575 69.332654-19.626474 97.279047-29.866374 145.491909-53.759474 305.490342-186.664839 358.18316-341.329991-27.306399 160.211765-165.331714 315.090248-303.35703 385.70289C505.595049 802.135506 447.995613 810.668756 327.46346 853.335004c-14.719856 5.333281-26.239743 10.453231-26.239743 10.453231h10.2399c26.879737-3.4133 50.772836-4.906619 50.772836-4.906618 171.731652-8.53325 441.595676 48.426192 567.034448-119.038835 127.998747-170.664996 56.746111-447.995613-2.133313-625.060546z"
          fill="#82B85E"
          p-id="1594"
        ></path>
        <path
          d="M231.677731 829.441905a44.372899 44.372899 0 0 1 6.186607 61.226067A43.370242 43.370242 0 0 1 170.664996 835.841842a42.666249 42.666249 0 0 1 61.226067-6.399937z m695.459857-716.57965c58.879423 178.131589 130.558722 454.182219 2.133313 625.060546C803.832129 905.387828 533.328111 848.428386 362.663116 856.961636c0 0-23.893099 1.70665-50.772837 4.906618H301.65038s11.519887-5.11995 26.239743-10.453231C447.995613 810.668756 505.595049 802.135506 579.40766 764.162544c138.025315-70.612642 276.05063-225.491125 303.35703-385.70289-52.692817 153.811827-213.331244 286.717193-358.18316 341.329991a2424.509593 2424.509593 0 0 1-280.317255 72.532624l-7.253262-4.053294c-122.238803-60.159411-126.505428-325.75681 96.852385-411.089308 97.919041-37.75963 190.718133-16.853168 297.170423-42.666249 112.638897-26.666406 243.624281-110.932247 296.103767-221.651163z"
          fill="#FFFFFF"
          p-id="1595"
        ></path>
      </svg>
    ),
    MySQL: (
      <svg
        t="1756706167047"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="4992"
        id="mx_n_1756706167050"
        width="40"
        height="40"
      >
        <path
          d="M1001.632 793.792c-7.84-13.856-26.016-37.536-93.12-83.2a1096.224 1096.224 0 0 0-125.152-74.144c-30.592-82.784-89.824-190.112-176.256-319.36-93.056-139.168-201.12-197.792-321.888-174.56a756.608 756.608 0 0 0-40.928-37.696C213.824 78.688 139.2 56.48 96.32 60.736c-19.424 1.952-34.016 9.056-43.36 21.088-21.664 27.904-14.432 68.064 85.504 198.912 19.008 55.616 23.072 84.672 23.072 99.296 0 30.912 15.968 66.368 49.984 110.752l-32 109.504c-28.544 97.792 23.328 224.288 71.616 268.384 25.76 23.552 47.456 20.032 58.176 15.84 21.504-8.448 38.848-29.472 50.048-89.504 5.728 14.112 11.808 29.312 18.208 45.6 34.56 87.744 68.352 136.288 106.336 152.736a32.032 32.032 0 0 0 25.44-58.688c-9.408-4.096-35.328-23.712-72.288-117.504-31.168-79.136-53.856-132.064-69.376-161.856a32.224 32.224 0 0 0-35.328-16.48 32.032 32.032 0 0 0-25.024 29.92c-3.872 91.04-13.056 130.4-19.2 147.008-26.496-30.464-68.128-125.984-47.232-197.536 20.768-71.232 32.992-112.928 36.64-125.248a31.936 31.936 0 0 0-5.888-29.28c-41.664-51.168-46.176-75.584-46.176-83.712 0-29.472-9.248-70.4-28.288-125.152a31.104 31.104 0 0 0-4.768-8.896c-53.824-70.112-73.6-105.216-80.832-121.888 25.632 1.216 74.336 15.04 91.008 29.376a660.8 660.8 0 0 1 49.024 46.304c8 8.448 19.968 11.872 31.232 8.928 100.192-25.92 188.928 21.152 271.072 144 87.808 131.328 146.144 238.048 173.408 317.216a32 32 0 0 0 16.384 18.432 1004.544 1004.544 0 0 1 128.8 75.264c7.392 5.024 14.048 9.696 20.064 14.016h-98.848a32.032 32.032 0 0 0-24.352 52.736 3098.752 3098.752 0 0 0 97.856 110.464 32 32 0 1 0 46.56-43.872 2237.6 2237.6 0 0 1-50.08-55.328h110.08a32.032 32.032 0 0 0 27.84-47.776z"
          p-id="4993"
          fill="#496d90"
        ></path>
        <path
          d="M320 289.472c12.672 21.76 22.464 37.344 29.344 46.784 8.288 16.256 21.184 29.248 29.44 45.536l2.016-1.984c14.528-9.952 25.92-49.504 2.752-75.488-12.032-18.176-51.04-17.664-63.552-14.848z"
          p-id="4994"
          fill="#496d90"
        ></path>
      </svg>
    ),
    "Tailwind": (
      <svg
        t="1756706225697"
        class="icon"
        viewBox="0 0 1024 1024"
        version="1.1"
        xmlns="http://www.w3.org/2000/svg"
        p-id="6272"
        width="40"
        height="40"
      >
        <path
          d="M288 438.4q44.8-179.2 224-179.2c179.2 0 201.6 134.4 291.2 156.8q89.6 22.4 156.8-67.2-44.8 179.2-224 179.2c-179.2 0-201.6-134.4-291.2-156.8q-89.6-22.4-156.8 67.2z m-224 268.8q44.8-179.2 224-179.2c179.2 0 201.6 134.4 291.2 156.8q89.6 22.4 156.8-67.2-44.8 179.2-224 179.2c-179.2 0-201.6-134.4-291.2-156.8q-89.6-22.4-156.8 67.2z"
          fill="#44A8B3"
          p-id="6273"
        ></path>
      </svg>
    ),
    // 为其他技能添加默认图标
    default: (
      <svg
        width="30"
        height="30"
        viewBox="0 0 30 30"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <circle
          cx="15"
          cy="15"
          r="13"
          fill="#6B7280"
          stroke="white"
          strokeWidth="1.5"
        />
        <text
          x="15"
          y="19"
          textAnchor="middle"
          fill="white"
          fontSize="9"
          fontWeight="bold"
        >
          T
        </text>
      </svg>
    ),
  };

  // 为技能生成图标
  const generateIcons = () => {
    return skills.map((skill) => {
      // 处理技能名称的匹配
      const normalizedSkill = skill.replace(/\s+/g, "");
      
      // 首先尝试精确匹配
      let iconKey = Object.keys(techIcons).find(
        (key) => key.toLowerCase() === skill.toLowerCase()
      );
      
      // 如果没有精确匹配，尝试包含匹配
      if (!iconKey) {
        iconKey = Object.keys(techIcons).find(
          (key) =>
            key.toLowerCase().includes(normalizedSkill.toLowerCase()) ||
            normalizedSkill.toLowerCase().includes(key.toLowerCase()) ||
            key.toLowerCase().replace(/\s+/g, "") === normalizedSkill.toLowerCase()
        );
      }

      // 调试信息
      console.log(`Skill: "${skill}" -> Normalized: "${normalizedSkill}" -> Found key: "${iconKey}"`);

      return techIcons[iconKey] || techIcons["default"];
    });
  };

  return (
    <div className="w-full h-full flex flex-col items-center justify-center p-6 lg:p-8">
      {/* 大标题 */}
          <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.2 }}
        className="text-center mb-8"
      >
        <h2 className="text-3xl lg:text-4xl font-bold text-foreground mb-3">
          {cardData?.title}
        </h2>
        <p className="text-base lg:text-lg text-muted-foreground">
          {cardData?.description}
        </p>
          </motion.div>

      {/* Orbiting Circles */}
      <motion.div
        initial={{ opacity: 0, scale: 0.8 }}
        animate={{ opacity: 1, scale: 1 }}
        transition={{ delay: 0.4, type: "spring", stiffness: 200 }}
        className="flex justify-center relative"
      >
        <div className="relative w-80 h-80 lg:w-96 lg:h-96 flex items-center justify-center">
          {/* 内圈轨道 */}
          <OrbitingCircles
            radius={80}
            duration={20}
            path={true}
            reverse={false}
            className="absolute"
          >
            {generateIcons()
              .slice(0, 3)
              .map((icon, index) => (
                <div
                  key={`inner-${index}`}
                  className="flex items-center justify-center"
                >
                  {icon}
        </div>
              ))}
          </OrbitingCircles>

          {/* 外圈轨道 */}
          <OrbitingCircles
            radius={140}
            duration={30}
            path={true}
            reverse={true}
            className="absolute"
          >
            {generateIcons()
              .slice(3)
              .map((icon, index) => (
                <div
                  key={`outer-${index}`}
                  className="flex items-center justify-center"
                  >
                    {icon}
                  </div>
                ))}
              </OrbitingCircles>
            </div>
          </motion.div>

      {/* 技能标签展示 */}
              <motion.div
        initial={{ opacity: 0, y: 20 }}
        animate={{ opacity: 1, y: 0 }}
        transition={{ delay: 0.6 }}
        className="flex flex-wrap justify-center gap-2 mt-6"
      >
        {skills.map((skill, index) => (
              <motion.span
                key={index}
            initial={{ opacity: 0, scale: 0.8 }}
            animate={{ opacity: 1, scale: 1 }}
            transition={{ delay: 0.7 + index * 0.05 }}
            className="px-3 py-1 bg-primary/10 text-primary text-sm font-medium rounded-full border border-primary/20 hover:bg-primary/20 hover:border-primary/30 transition-all duration-300"
              >
                {skill}
              </motion.span>
            ))}
        </motion.div>
    </div>
  );
};

export default FullStackCard;
